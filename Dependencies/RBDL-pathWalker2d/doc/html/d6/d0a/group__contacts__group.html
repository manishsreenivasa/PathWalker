<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Rigid Body Dynamics Library: Contacts</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Rigid Body Dynamics Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d6/d0a/group__contacts__group.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Contacts</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de7/struct_rigid_body_dynamics_1_1_constraint_set.html">ConstraintSet</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure that contains both constraint information and workspace memory.  <a href="../../d7/de7/struct_rigid_body_dynamics_1_1_constraint_set.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga525eb953ed31a188614c97383169f435"><td class="memItemLeft" align="right" valign="top">RBDL_DLLAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d0a/group__contacts__group.html#ga525eb953ed31a188614c97383169f435">CalcContactJacobian</a> (Model &amp;model, const Math::VectorNd &amp;Q, const ConstraintSet &amp;CS, Math::MatrixNd &amp;G, bool update_kinematics=true)</td></tr>
<tr class="memdesc:ga525eb953ed31a188614c97383169f435"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the Jacobian for the given <a class="el" href="../../d7/de7/struct_rigid_body_dynamics_1_1_constraint_set.html" title="Structure that contains both constraint information and workspace memory. ">ConstraintSet</a>.  <a href="#ga525eb953ed31a188614c97383169f435">More...</a><br/></td></tr>
<tr class="separator:ga525eb953ed31a188614c97383169f435"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga90140e96696eda3f5fb90e83c07e9540"><td class="memItemLeft" align="right" valign="top">RBDL_DLLAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d0a/group__contacts__group.html#ga90140e96696eda3f5fb90e83c07e9540">CalcContactSystemVariables</a> (Model &amp;model, const Math::VectorNd &amp;Q, const Math::VectorNd &amp;QDot, const Math::VectorNd &amp;Tau, ConstraintSet &amp;CS)</td></tr>
<tr class="separator:ga90140e96696eda3f5fb90e83c07e9540"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac391ba64d106c8c9a1423190397292c8"><td class="memItemLeft" align="right" valign="top">RBDL_DLLAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d0a/group__contacts__group.html#gac391ba64d106c8c9a1423190397292c8">ForwardDynamicsContactsDirect</a> (Model &amp;model, const Math::VectorNd &amp;Q, const Math::VectorNd &amp;QDot, const Math::VectorNd &amp;Tau, ConstraintSet &amp;CS, Math::VectorNd &amp;QDDot)</td></tr>
<tr class="memdesc:gac391ba64d106c8c9a1423190397292c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes forward dynamics with contact by constructing and solving the full lagrangian equation.  <a href="#gac391ba64d106c8c9a1423190397292c8">More...</a><br/></td></tr>
<tr class="separator:gac391ba64d106c8c9a1423190397292c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf140d8cf9b423912c21c8ddb703f6175"><td class="memItemLeft" align="right" valign="top">RBDL_DLLAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d0a/group__contacts__group.html#gaf140d8cf9b423912c21c8ddb703f6175">ForwardDynamicsContactsRangeSpaceSparse</a> (Model &amp;model, const Math::VectorNd &amp;Q, const Math::VectorNd &amp;QDot, const Math::VectorNd &amp;Tau, ConstraintSet &amp;CS, Math::VectorNd &amp;QDDot)</td></tr>
<tr class="separator:gaf140d8cf9b423912c21c8ddb703f6175"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadc45154c3287dbeeb10aa38ae1ced107"><td class="memItemLeft" align="right" valign="top">RBDL_DLLAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d0a/group__contacts__group.html#gadc45154c3287dbeeb10aa38ae1ced107">ForwardDynamicsContactsNullSpace</a> (Model &amp;model, const VectorNd &amp;Q, const VectorNd &amp;QDot, const VectorNd &amp;Tau, ConstraintSet &amp;CS, VectorNd &amp;QDDot)</td></tr>
<tr class="separator:gadc45154c3287dbeeb10aa38ae1ced107"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa9cff799e1e2fc962658fe378708b720"><td class="memItemLeft" align="right" valign="top">RBDL_DLLAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d0a/group__contacts__group.html#gaa9cff799e1e2fc962658fe378708b720">ForwardDynamicsContactsKokkevis</a> (Model &amp;model, const Math::VectorNd &amp;Q, const Math::VectorNd &amp;QDot, const Math::VectorNd &amp;Tau, ConstraintSet &amp;CS, Math::VectorNd &amp;QDDot)</td></tr>
<tr class="memdesc:gaa9cff799e1e2fc962658fe378708b720"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes forward dynamics that accounts for active contacts in <a class="el" href="../../d7/de7/struct_rigid_body_dynamics_1_1_constraint_set.html" title="Structure that contains both constraint information and workspace memory. ">ConstraintSet</a>.  <a href="#gaa9cff799e1e2fc962658fe378708b720">More...</a><br/></td></tr>
<tr class="separator:gaa9cff799e1e2fc962658fe378708b720"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad31e6014f9c496ff809519fe2ad0ba5b"><td class="memItemLeft" align="right" valign="top">RBDL_DLLAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d0a/group__contacts__group.html#gad31e6014f9c496ff809519fe2ad0ba5b">ComputeContactImpulsesDirect</a> (Model &amp;model, const Math::VectorNd &amp;Q, const Math::VectorNd &amp;QDotMinus, ConstraintSet &amp;CS, Math::VectorNd &amp;QDotPlus)</td></tr>
<tr class="memdesc:gad31e6014f9c496ff809519fe2ad0ba5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes contact gain by constructing and solving the full lagrangian equation.  <a href="#gad31e6014f9c496ff809519fe2ad0ba5b">More...</a><br/></td></tr>
<tr class="separator:gad31e6014f9c496ff809519fe2ad0ba5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga61cbb69c0894a35f5024a9b9dcb0d98a"><td class="memItemLeft" align="right" valign="top">RBDL_DLLAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d0a/group__contacts__group.html#ga61cbb69c0894a35f5024a9b9dcb0d98a">ComputeContactImpulsesRangeSpaceSparse</a> (Model &amp;model, const Math::VectorNd &amp;Q, const Math::VectorNd &amp;QDotMinus, ConstraintSet &amp;CS, Math::VectorNd &amp;QDotPlus)</td></tr>
<tr class="memdesc:ga61cbb69c0894a35f5024a9b9dcb0d98a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resolves contact gain using <a class="el" href="../../d6/d0a/group__contacts__group.html#ga58bd5b79a0971abe3fc06703f17175ba" title="Solves the contact system by first solving for the the joint accelerations and then the contact force...">SolveContactSystemRangeSpaceSparse()</a>  <a href="#ga61cbb69c0894a35f5024a9b9dcb0d98a">More...</a><br/></td></tr>
<tr class="separator:ga61cbb69c0894a35f5024a9b9dcb0d98a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac52f2680e6d2fe262bb4399c611fb2d2"><td class="memItemLeft" align="right" valign="top">RBDL_DLLAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d0a/group__contacts__group.html#gac52f2680e6d2fe262bb4399c611fb2d2">ComputeContactImpulsesNullSpace</a> (Model &amp;model, const Math::VectorNd &amp;Q, const Math::VectorNd &amp;QDotMinus, ConstraintSet &amp;CS, Math::VectorNd &amp;QDotPlus)</td></tr>
<tr class="memdesc:gac52f2680e6d2fe262bb4399c611fb2d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resolves contact gain using <a class="el" href="../../d6/d0a/group__contacts__group.html#ga8bac05d59832b1431a4a12f32eb3d8d5" title="Solves the contact system by first solving for the joint accelerations and then for the constraint fo...">SolveContactSystemNullSpace()</a>  <a href="#gac52f2680e6d2fe262bb4399c611fb2d2">More...</a><br/></td></tr>
<tr class="separator:gac52f2680e6d2fe262bb4399c611fb2d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga77fdfb3e7d52e77ef0d5146747e4f3fc"><td class="memItemLeft" align="right" valign="top">RBDL_DLLAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d0a/group__contacts__group.html#ga77fdfb3e7d52e77ef0d5146747e4f3fc">SolveContactSystemDirect</a> (Math::MatrixNd &amp;H, const Math::MatrixNd &amp;G, const Math::VectorNd &amp;c, const Math::VectorNd &amp;gamma, Math::VectorNd &amp;qddot, Math::VectorNd &amp;lambda, Math::MatrixNd &amp;A, Math::VectorNd &amp;b, Math::VectorNd &amp;x, Math::LinearSolver &amp;linear_solver)</td></tr>
<tr class="memdesc:ga77fdfb3e7d52e77ef0d5146747e4f3fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves the full contact system directly, i.e. simultaneously for contact forces and joint accelerations.  <a href="#ga77fdfb3e7d52e77ef0d5146747e4f3fc">More...</a><br/></td></tr>
<tr class="separator:ga77fdfb3e7d52e77ef0d5146747e4f3fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga58bd5b79a0971abe3fc06703f17175ba"><td class="memItemLeft" align="right" valign="top">RBDL_DLLAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d0a/group__contacts__group.html#ga58bd5b79a0971abe3fc06703f17175ba">SolveContactSystemRangeSpaceSparse</a> (Model &amp;model, Math::MatrixNd &amp;H, const Math::MatrixNd &amp;G, const Math::VectorNd &amp;c, const Math::VectorNd &amp;gamma, Math::VectorNd &amp;qddot, Math::VectorNd &amp;lambda, Math::MatrixNd &amp;K, Math::VectorNd &amp;a, Math::LinearSolver linear_solver)</td></tr>
<tr class="memdesc:ga58bd5b79a0971abe3fc06703f17175ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves the contact system by first solving for the the joint accelerations and then the contact forces using a sparse matrix decomposition of the joint space inertia matrix.  <a href="#ga58bd5b79a0971abe3fc06703f17175ba">More...</a><br/></td></tr>
<tr class="separator:ga58bd5b79a0971abe3fc06703f17175ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8bac05d59832b1431a4a12f32eb3d8d5"><td class="memItemLeft" align="right" valign="top">RBDL_DLLAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d0a/group__contacts__group.html#ga8bac05d59832b1431a4a12f32eb3d8d5">SolveContactSystemNullSpace</a> (Math::MatrixNd &amp;H, const Math::MatrixNd &amp;G, const Math::VectorNd &amp;c, const Math::VectorNd &amp;gamma, Math::VectorNd &amp;qddot, Math::VectorNd &amp;lambda, Math::MatrixNd &amp;Y, Math::MatrixNd &amp;Z, Math::VectorNd &amp;qddot_y, Math::VectorNd &amp;qddot_z, Math::LinearSolver &amp;linear_solver)</td></tr>
<tr class="memdesc:ga8bac05d59832b1431a4a12f32eb3d8d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves the contact system by first solving for the joint accelerations and then for the constraint forces.  <a href="#ga8bac05d59832b1431a4a12f32eb3d8d5">More...</a><br/></td></tr>
<tr class="separator:ga8bac05d59832b1431a4a12f32eb3d8d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>External contacts are handled by specification of a <a class="el" href="../../d7/de7/struct_rigid_body_dynamics_1_1_constraint_set.html">ConstraintSet </a> which contains all informations about the current contacts and workspace memory.</p>
<p>Separate contacts can be specified by calling <a class="el" href="../../d7/de7/struct_rigid_body_dynamics_1_1_constraint_set.html#a379167ec7feeb91edaa058c359c8aeeb" title="Adds a constraint to the constraint set. ">ConstraintSet::AddConstraint()</a>. After all constraints have been specified, this <a class="el" href="../../d7/de7/struct_rigid_body_dynamics_1_1_constraint_set.html">ConstraintSet </a> has to be bound to the model via <a class="el" href="../../d7/de7/struct_rigid_body_dynamics_1_1_constraint_set.html#ae4488dbfec02efc4c619ead2fcaaa7d9" title="Initializes and allocates memory for the constraint set. ">ConstraintSet::Bind()</a>. This initializes workspace memory that is later used when calling one of the contact functions, such as ForwardDynamicsContacts() or ForwardDynamicsContactsLagrangian().</p>
<p>The values in the vectors <a class="el" href="../../d7/de7/struct_rigid_body_dynamics_1_1_constraint_set.html#a9b96834a8bbeb859d4c5bb2889b14cde">ConstraintSet::force</a> and <a class="el" href="../../d7/de7/struct_rigid_body_dynamics_1_1_constraint_set.html#a24ccb84dfb5b40b9e4539a1dcbdb1916">ConstraintSet::impulse</a> contain the computed force or impulse values for each constraint when returning from one of the contact functions.</p>
<h1><a class="anchor" id="solution_constraint_system"></a>
Solution of the Constraint System</h1>
<h2><a class="anchor" id="constraint_system"></a>
Linear System of the Constrained Dynamics</h2>
<p>External contacts are constraints that act on the model. To compute the acceleration one has to solve a linear system of the form: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left( \begin{array}{cc} H &amp; G^T \\ G &amp; 0 \end{array} \right) \left( \begin{array}{c} \ddot{q} \\ - \lambda \end{array} \right) = \left( \begin{array}{c} -C + \tau \\ \gamma \end{array} \right) \]" src="../../form_0.png"/>
</p>
<p> where <img class="formulaInl" alt="$H$" src="../../form_1.png"/> is the joint space inertia matrix computed with the <a class="el" href="../../d6/d63/group__dynamics__group.html#ga16a9d225d96d260af451f69e258d0875" title="Computes the joint space inertia matrix by using the Composite Rigid Body Algorithm. ">CompositeRigidBodyAlgorithm()</a>, <img class="formulaInl" alt="$G$" src="../../form_2.png"/> are the point jacobians of the contact points, <img class="formulaInl" alt="$C$" src="../../form_3.png"/> the bias force (sometimes called "non-linear
  effects"), and <img class="formulaInl" alt="$\gamma$" src="../../form_4.png"/> the generalized acceleration independent part of the contact point accelerations.</p>
<h2><a class="anchor" id="collision_system"></a>
Linear System of the Contact Collision</h2>
<p>Similarly to compute the response of the model to a contact gain one has to solve a system of the following form: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left( \begin{array}{cc} H &amp; G^T \\ G &amp; 0 \end{array} \right) \left( \begin{array}{c} \dot{q}^{+} \\ \Lambda \end{array} \right) = \left( \begin{array}{c} H \dot{q}^{-} \\ v^{+} \end{array} \right) \]" src="../../form_5.png"/>
</p>
<p> where <img class="formulaInl" alt="$H$" src="../../form_1.png"/> is the joint space inertia matrix computed with the <a class="el" href="../../d6/d63/group__dynamics__group.html#ga16a9d225d96d260af451f69e258d0875" title="Computes the joint space inertia matrix by using the Composite Rigid Body Algorithm. ">CompositeRigidBodyAlgorithm()</a>, <img class="formulaInl" alt="$G$" src="../../form_2.png"/> are the point jacobians of the contact points, <img class="formulaInl" alt="$\dot{q}^{+}$" src="../../form_6.png"/> the generalized velocity after the impact, <img class="formulaInl" alt="$\Lambda$" src="../../form_7.png"/> the impulses at each constraint, <img class="formulaInl" alt="$\dot{q}^{-}$" src="../../form_8.png"/> the generalized velocity before the impact, and <img class="formulaInl" alt="$v^{+}$" src="../../form_9.png"/> the desired velocity of each constraint after the impact (known beforehand, usually 0). The value of <img class="formulaInl" alt="$v^{+}$" src="../../form_9.png"/> can is specified via the variable <a class="el" href="../../d7/de7/struct_rigid_body_dynamics_1_1_constraint_set.html#aa85422fa19c98f69d05e2df5aa08032e">ConstraintSet::v_plus</a> and defaults to 0.</p>
<h2><a class="anchor" id="solution_methods"></a>
Solution Methods</h2>
<p>There are essentially three different approaches to solve these systems:</p>
<ol type="1">
<li><b>Direct:</b> solve the full system to simultaneously compute <img class="formulaInl" alt="$\ddot{q}$" src="../../form_10.png"/> and <img class="formulaInl" alt="$\lambda$" src="../../form_11.png"/>. This may be slow for large systems and many constraints.</li>
<li><b>Range-Space</b>: solve first for <img class="formulaInl" alt="$\lambda$" src="../../form_11.png"/> and then for <img class="formulaInl" alt="$\ddot{q}$" src="../../form_10.png"/>.</li>
<li><b>Null-Space</b>: solve furst for <img class="formulaInl" alt="$\ddot{q}$" src="../../form_10.png"/> and then for <img class="formulaInl" alt="$\lambda$" src="../../form_11.png"/> The methods are the same for the contact gaints just with different variables on the right-hand-side.</li>
</ol>
<p>RBDL provides methods for all approaches. The implementation for the range-space method also exploits sparsities in the joint space inertia matrix using a sparse structure preserving <img class="formulaInl" alt="$L^TL$" src="../../form_12.png"/> decomposition as described in Chapter 8.5 of "Rigid Body Dynamics Algorithms".</p>
<p>None of the methods is generally superior to the others and each has different trade-offs as factors such as model topology, number of constraints, constrained bodies, numerical stability, and performance vary and evaluation has to be made on a case-by-case basis.</p>
<h2><a class="anchor" id="solving_constraints_dynamics"></a>
Methods for Solving Constrained Dynamics</h2>
<p>RBDL provides the following methods to compute the acceleration of a constrained system:</p>
<ul>
<li><a class="el" href="../../d6/d0a/group__contacts__group.html#gac391ba64d106c8c9a1423190397292c8" title="Computes forward dynamics with contact by constructing and solving the full lagrangian equation...">ForwardDynamicsContactsDirect()</a></li>
<li><a class="el" href="../../d6/d0a/group__contacts__group.html#gaf140d8cf9b423912c21c8ddb703f6175">ForwardDynamicsContactsRangeSpaceSparse()</a></li>
<li><a class="el" href="../../d6/d0a/group__contacts__group.html#gadc45154c3287dbeeb10aa38ae1ced107">ForwardDynamicsContactsNullSpace()</a></li>
</ul>
<h2><a class="anchor" id="solving_constraints_collisions"></a>
Methods for Computing Collisions</h2>
<p>RBDL provides the following methods to compute the collision response on new contact gains:</p>
<ul>
<li><a class="el" href="../../d6/d0a/group__contacts__group.html#gad31e6014f9c496ff809519fe2ad0ba5b" title="Computes contact gain by constructing and solving the full lagrangian equation. ">ComputeContactImpulsesDirect()</a></li>
<li><a class="el" href="../../d6/d0a/group__contacts__group.html#ga61cbb69c0894a35f5024a9b9dcb0d98a" title="Resolves contact gain using SolveContactSystemRangeSpaceSparse() ">ComputeContactImpulsesRangeSpaceSparse()</a></li>
<li><a class="el" href="../../d6/d0a/group__contacts__group.html#gac52f2680e6d2fe262bb4399c611fb2d2" title="Resolves contact gain using SolveContactSystemNullSpace() ">ComputeContactImpulsesNullSpace()</a> </li>
</ul>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga525eb953ed31a188614c97383169f435"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RBDL_DLLAPI void CalcContactJacobian </td>
          <td>(</td>
          <td class="paramtype">Model &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ConstraintSet &amp;&#160;</td>
          <td class="paramname"><em>CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::MatrixNd &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>update_kinematics</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the Jacobian for the given <a class="el" href="../../d7/de7/struct_rigid_body_dynamics_1_1_constraint_set.html" title="Structure that contains both constraint information and workspace memory. ">ConstraintSet</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">model</td><td>the model </td></tr>
    <tr><td class="paramname">Q</td><td>the generalized positions of the joints </td></tr>
    <tr><td class="paramname">CS</td><td>the constraint set for which the Jacobian should be computed </td></tr>
    <tr><td class="paramname">G</td><td>(output) matrix where the output will be stored in </td></tr>
    <tr><td class="paramname">update_kinematics</td><td>whether the kinematics of the model should be * updated from Q </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00309">309</a> of file <a class="el" href="../../de/dbb/_contacts_8cc_source.html">Contacts.cc</a>.</p>

<p>References <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00227">ConstraintSet::body</a>, <a class="el" href="../../d4/de5/_kinematics_8cc_source.html#l00254">RigidBodyDynamics::CalcPointJacobian()</a>, <a class="el" href="../../da/ded/_model_8h_source.html#l00139">Model::dof_count</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00229">ConstraintSet::normal</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00228">ConstraintSet::point</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00214">ConstraintSet::size()</a>, and <a class="el" href="../../d4/de5/_kinematics_8cc_source.html#l00087">RigidBodyDynamics::UpdateKinematicsCustom()</a>.</p>

</div>
</div>
<a class="anchor" id="ga90140e96696eda3f5fb90e83c07e9540"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RBDL_DLLAPI void CalcContactSystemVariables </td>
          <td>(</td>
          <td class="paramtype">Model &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>QDot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>Tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ConstraintSet &amp;&#160;</td>
          <td class="paramname"><em>CS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00343">343</a> of file <a class="el" href="../../de/dbb/_contacts_8cc_source.html">Contacts.cc</a>.</p>

<p>References <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00233">ConstraintSet::acceleration</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00227">ConstraintSet::body</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00247">ConstraintSet::C</a>, <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00309">RigidBodyDynamics::CalcContactJacobian()</a>, <a class="el" href="../../d4/de5/_kinematics_8cc_source.html#l00525">RigidBodyDynamics::CalcPointAcceleration()</a>, <a class="el" href="../../de/d3c/_dynamics_8cc_source.html#l00163">RigidBodyDynamics::CompositeRigidBodyAlgorithm()</a>, <a class="el" href="../../da/ded/_model_8h_source.html#l00139">Model::dof_count</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00250">ConstraintSet::G</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00249">ConstraintSet::gamma</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00245">ConstraintSet::H</a>, <a class="el" href="../../da/ded/_model_8h_source.html#l00127">Model::lambda</a>, <a class="el" href="../../da/ded/_model_8h_source.html#l00262">Model::mBodies</a>, <a class="el" href="../../de/d3c/_dynamics_8cc_source.html#l00107">RigidBodyDynamics::NonlinearEffects()</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00229">ConstraintSet::normal</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00228">ConstraintSet::point</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00280">ConstraintSet::QDDot_0</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00214">ConstraintSet::size()</a>, <a class="el" href="../../d4/de5/_kinematics_8cc_source.html#l00087">RigidBodyDynamics::UpdateKinematicsCustom()</a>, <a class="el" href="../../da/ded/_model_8h_source.html#l00237">Model::X_base</a>, and <a class="el" href="../../da/ded/_model_8h_source.html#l00235">Model::X_lambda</a>.</p>

</div>
</div>
<a class="anchor" id="gad31e6014f9c496ff809519fe2ad0ba5b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RBDL_DLLAPI void ComputeContactImpulsesDirect </td>
          <td>(</td>
          <td class="paramtype">Model &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>QDotMinus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ConstraintSet &amp;&#160;</td>
          <td class="paramname"><em>CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>QDotPlus</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes contact gain by constructing and solving the full lagrangian equation. </p>
<p>This method builds and solves the linear system </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left( \begin{array}{cc} H &amp; G^T \\ G &amp; 0 \end{array} \right) \left( \begin{array}{c} \dot{q}^{+} \\ \Lambda \end{array} \right) = \left( \begin{array}{c} H \dot{q}^{-} \\ v^{+} \end{array} \right) \]" src="../../form_5.png"/>
</p>
<p> where <img class="formulaInl" alt="$H$" src="../../form_1.png"/> is the joint space inertia matrix computed with the <a class="el" href="../../d6/d63/group__dynamics__group.html#ga16a9d225d96d260af451f69e258d0875" title="Computes the joint space inertia matrix by using the Composite Rigid Body Algorithm. ">CompositeRigidBodyAlgorithm()</a>, <img class="formulaInl" alt="$G$" src="../../form_2.png"/> are the point jacobians of the contact points, <img class="formulaInl" alt="$\dot{q}^{+}$" src="../../form_6.png"/> the generalized velocity after the impact, <img class="formulaInl" alt="$\Lambda$" src="../../form_7.png"/> the impulses at each constraint, <img class="formulaInl" alt="$\dot{q}^{-}$" src="../../form_8.png"/> the generalized velocity before the impact, and <img class="formulaInl" alt="$v^{+}$" src="../../form_9.png"/> the desired velocity of each constraint after the impact (known beforehand, usually 0). The value of <img class="formulaInl" alt="$v^{+}$" src="../../form_9.png"/> can is specified via the variable <a class="el" href="../../d7/de7/struct_rigid_body_dynamics_1_1_constraint_set.html#aa85422fa19c98f69d05e2df5aa08032e">ConstraintSet::v_plus</a> and defaults to 0.</p>
<dl class="section note"><dt>Note</dt><dd>So far, only constraints acting along cartesian coordinate axes are allowed (i.e. (1, 0, 0), (0, 1, 0), and (0, 0, 1)). Also, one must not specify redundant constraints!</dd></dl>
<dl class="section user"><dt></dt><dd></dd></dl>
<dl class="section note"><dt>Note</dt><dd>To increase performance group constraints body and pointwise such that constraints acting on the same body point are sequentially in <a class="el" href="../../d7/de7/struct_rigid_body_dynamics_1_1_constraint_set.html" title="Structure that contains both constraint information and workspace memory. ">ConstraintSet</a>. This can save computation of point Jacobians <img class="formulaInl" alt="$G$" src="../../form_2.png"/>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">model</td><td>rigid body model </td></tr>
    <tr><td class="paramname">Q</td><td>state vector of the internal joints </td></tr>
    <tr><td class="paramname">QDotMinus</td><td>velocity vector of the internal joints before the impact </td></tr>
    <tr><td class="paramname">CS</td><td>the set of active constraints </td></tr>
    <tr><td class="paramname">QDotPlus</td><td>velocities of the internals joints after the impact (output) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00454">454</a> of file <a class="el" href="../../de/dbb/_contacts_8cc_source.html">Contacts.cc</a>.</p>

<p>References <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00252">ConstraintSet::A</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00254">ConstraintSet::b</a>, <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00309">RigidBodyDynamics::CalcContactJacobian()</a>, <a class="el" href="../../de/d3c/_dynamics_8cc_source.html#l00163">RigidBodyDynamics::CompositeRigidBodyAlgorithm()</a>, <a class="el" href="../../da/ded/_model_8h_source.html#l00139">Model::dof_count</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00250">ConstraintSet::G</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00245">ConstraintSet::H</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00237">ConstraintSet::impulse</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00222">ConstraintSet::linear_solver</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00214">ConstraintSet::size()</a>, <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00161">RigidBodyDynamics::SolveContactSystemDirect()</a>, <a class="el" href="../../d4/de5/_kinematics_8cc_source.html#l00087">RigidBodyDynamics::UpdateKinematicsCustom()</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00240">ConstraintSet::v_plus</a>, and <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00256">ConstraintSet::x</a>.</p>

</div>
</div>
<a class="anchor" id="gac52f2680e6d2fe262bb4399c611fb2d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RBDL_DLLAPI void ComputeContactImpulsesNullSpace </td>
          <td>(</td>
          <td class="paramtype">Model &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>QDotMinus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ConstraintSet &amp;&#160;</td>
          <td class="paramname"><em>CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>QDotPlus</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resolves contact gain using <a class="el" href="../../d6/d0a/group__contacts__group.html#ga8bac05d59832b1431a4a12f32eb3d8d5" title="Solves the contact system by first solving for the joint accelerations and then for the constraint fo...">SolveContactSystemNullSpace()</a> </p>

<p>Definition at line <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00499">499</a> of file <a class="el" href="../../de/dbb/_contacts_8cc_source.html">Contacts.cc</a>.</p>

<p>References <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00309">RigidBodyDynamics::CalcContactJacobian()</a>, <a class="el" href="../../de/d3c/_dynamics_8cc_source.html#l00163">RigidBodyDynamics::CompositeRigidBodyAlgorithm()</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00250">ConstraintSet::G</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00262">ConstraintSet::GT_qr</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00265">ConstraintSet::GT_qr_Q</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00245">ConstraintSet::H</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00237">ConstraintSet::impulse</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00222">ConstraintSet::linear_solver</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00268">ConstraintSet::qddot_y</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00269">ConstraintSet::qddot_z</a>, <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00248">RigidBodyDynamics::SolveContactSystemNullSpace()</a>, <a class="el" href="../../d4/de5/_kinematics_8cc_source.html#l00087">RigidBodyDynamics::UpdateKinematicsCustom()</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00240">ConstraintSet::v_plus</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00266">ConstraintSet::Y</a>, and <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00267">ConstraintSet::Z</a>.</p>

</div>
</div>
<a class="anchor" id="ga61cbb69c0894a35f5024a9b9dcb0d98a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RBDL_DLLAPI void ComputeContactImpulsesRangeSpaceSparse </td>
          <td>(</td>
          <td class="paramtype">Model &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>QDotMinus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ConstraintSet &amp;&#160;</td>
          <td class="paramname"><em>CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>QDotPlus</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resolves contact gain using <a class="el" href="../../d6/d0a/group__contacts__group.html#ga58bd5b79a0971abe3fc06703f17175ba" title="Solves the contact system by first solving for the the joint accelerations and then the contact force...">SolveContactSystemRangeSpaceSparse()</a> </p>

<p>Definition at line <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00481">481</a> of file <a class="el" href="../../de/dbb/_contacts_8cc_source.html">Contacts.cc</a>.</p>

<p>References <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00276">ConstraintSet::a</a>, <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00309">RigidBodyDynamics::CalcContactJacobian()</a>, <a class="el" href="../../de/d3c/_dynamics_8cc_source.html#l00163">RigidBodyDynamics::CompositeRigidBodyAlgorithm()</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00250">ConstraintSet::G</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00245">ConstraintSet::H</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00237">ConstraintSet::impulse</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00274">ConstraintSet::K</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00222">ConstraintSet::linear_solver</a>, <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00211">RigidBodyDynamics::SolveContactSystemRangeSpaceSparse()</a>, <a class="el" href="../../d4/de5/_kinematics_8cc_source.html#l00087">RigidBodyDynamics::UpdateKinematicsCustom()</a>, and <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00240">ConstraintSet::v_plus</a>.</p>

</div>
</div>
<a class="anchor" id="gac391ba64d106c8c9a1423190397292c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RBDL_DLLAPI void ForwardDynamicsContactsDirect </td>
          <td>(</td>
          <td class="paramtype">Model &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>QDot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>Tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ConstraintSet &amp;&#160;</td>
          <td class="paramname"><em>CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>QDDot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes forward dynamics with contact by constructing and solving the full lagrangian equation. </p>
<p>This method builds and solves the linear system </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left( \begin{array}{cc} H &amp; G^T \\ G &amp; 0 \end{array} \right) \left( \begin{array}{c} \ddot{q} \\ -\lambda \end{array} \right) = \left( \begin{array}{c} -C + \tau \\ \gamma \end{array} \right) \]" src="../../form_13.png"/>
</p>
<p> where <img class="formulaInl" alt="$H$" src="../../form_1.png"/> is the joint space inertia matrix computed with the <a class="el" href="../../d6/d63/group__dynamics__group.html#ga16a9d225d96d260af451f69e258d0875" title="Computes the joint space inertia matrix by using the Composite Rigid Body Algorithm. ">CompositeRigidBodyAlgorithm()</a>, <img class="formulaInl" alt="$G$" src="../../form_2.png"/> are the point jacobians of the contact points, <img class="formulaInl" alt="$C$" src="../../form_3.png"/> the bias force (sometimes called "non-linear
  effects"), and <img class="formulaInl" alt="$\gamma$" src="../../form_4.png"/> the generalized acceleration independent part of the contact point accelerations.</p>
<dl class="section note"><dt>Note</dt><dd>So far, only constraints acting along cartesian coordinate axes are allowed (i.e. (1, 0, 0), (0, 1, 0), and (0, 0, 1)). Also, one must not specify redundant constraints!</dd></dl>
<dl class="section user"><dt></dt><dd></dd></dl>
<dl class="section note"><dt>Note</dt><dd>To increase performance group constraints body and pointwise such that constraints acting on the same body point are sequentially in <a class="el" href="../../d7/de7/struct_rigid_body_dynamics_1_1_constraint_set.html" title="Structure that contains both constraint information and workspace memory. ">ConstraintSet</a>. This can save computation of point jacobians <img class="formulaInl" alt="$G$" src="../../form_2.png"/>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">model</td><td>rigid body model </td></tr>
    <tr><td class="paramname">Q</td><td>state vector of the internal joints </td></tr>
    <tr><td class="paramname">QDot</td><td>velocity vector of the internal joints </td></tr>
    <tr><td class="paramname">Tau</td><td>actuations of the internal joints </td></tr>
    <tr><td class="paramname">CS</td><td>the description of all acting constraints </td></tr>
    <tr><td class="paramname">QDDot</td><td>accelerations of the internals joints (output)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>During execution of this function values such as <a class="el" href="../../d7/de7/struct_rigid_body_dynamics_1_1_constraint_set.html#a9b96834a8bbeb859d4c5bb2889b14cde">ConstraintSet::force</a> get modified and will contain the value of the force acting along the normal. </dd></dl>

<p>Definition at line <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00388">388</a> of file <a class="el" href="../../de/dbb/_contacts_8cc_source.html">Contacts.cc</a>.</p>

<p>References <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00252">ConstraintSet::A</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00254">ConstraintSet::b</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00247">ConstraintSet::C</a>, <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00343">RigidBodyDynamics::CalcContactSystemVariables()</a>, <a class="el" href="../../da/ded/_model_8h_source.html#l00139">Model::dof_count</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00235">ConstraintSet::force</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00250">ConstraintSet::G</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00249">ConstraintSet::gamma</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00245">ConstraintSet::H</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00222">ConstraintSet::linear_solver</a>, <a class="el" href="../../da/def/_logging_8h_source.html#l00024">LOG</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00214">ConstraintSet::size()</a>, <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00161">RigidBodyDynamics::SolveContactSystemDirect()</a>, and <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00256">ConstraintSet::x</a>.</p>

</div>
</div>
<a class="anchor" id="gaa9cff799e1e2fc962658fe378708b720"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RBDL_DLLAPI void ForwardDynamicsContactsKokkevis </td>
          <td>(</td>
          <td class="paramtype">Model &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>QDot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>Tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ConstraintSet &amp;&#160;</td>
          <td class="paramname"><em>CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>QDDot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes forward dynamics that accounts for active contacts in <a class="el" href="../../d7/de7/struct_rigid_body_dynamics_1_1_constraint_set.html" title="Structure that contains both constraint information and workspace memory. ">ConstraintSet</a>. </p>
<p>The method used here is the one described by Kokkevis and Metaxas in the Paper "Practical Physics for Articulated Characters", Game Developers Conference, 2004.</p>
<p>It does this by recursively computing the inverse articulated-body inertia (IABI) </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left( \begin{array}{c} \dot{v}_1 \\ \dot{v}_2 \\ \vdots \\ \dot{v}_n \end{array} \right) = \left( \begin{array}{cccc} \Phi_{1,1} &amp; \Phi_{1,2} &amp; \cdots &amp; \Phi{1,n} \\ \Phi_{2,1} &amp; \Phi_{2,2} &amp; \cdots &amp; \Phi{2,n} \\ \cdots &amp; \cdots &amp; \cdots &amp; \vdots \\ \Phi_{n,1} &amp; \Phi_{n,2} &amp; \cdots &amp; \Phi{n,n} \end{array} \right) \left( \begin{array}{c} f_1 \\ f_2 \\ \vdots \\ f_n \end{array} \right) + \left( \begin{array}{c} \phi_1 \\ \phi_2 \\ \vdots \\ \phi_n \end{array} \right). \]" src="../../form_14.png"/>
</p>
<p> <img class="formulaInl" alt="$\Phi_{i,j}$" src="../../form_15.png"/> which is then used to build and solve a system of the form: Here <img class="formulaInl" alt="$n$" src="../../form_16.png"/> is the number of constraints and the method for building the system uses the Articulated <a class="el" href="../../da/dd2/struct_rigid_body_dynamics_1_1_body.html" title="Describes all properties of a single body. ">Body</a> Algorithm to efficiently compute entries of the system. The values <img class="formulaInl" alt="$\dot{v}_i$" src="../../form_17.png"/> are the constraint accelerations, <img class="formulaInl" alt="$f_i$" src="../../form_18.png"/> the constraint forces, and <img class="formulaInl" alt="$\phi_i$" src="../../form_19.png"/> are the constraint bias forces.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">model</td><td>rigid body model </td></tr>
    <tr><td class="paramname">Q</td><td>state vector of the internal joints </td></tr>
    <tr><td class="paramname">QDot</td><td>velocity vector of the internal joints </td></tr>
    <tr><td class="paramname">Tau</td><td>actuations of the internal joints </td></tr>
    <tr><td class="paramname">CS</td><td>a list of all contact points </td></tr>
    <tr><td class="paramname">QDDot</td><td>accelerations of the internals joints (output)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>During execution of this function values such as <a class="el" href="../../d7/de7/struct_rigid_body_dynamics_1_1_constraint_set.html#a9b96834a8bbeb859d4c5bb2889b14cde">ConstraintSet::force</a> get modified and will contain the value of the force acting along the normal.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000001">Todo:</a></b></dt><dd>Allow for external forces </dd></dl>

<p>Definition at line <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00836">836</a> of file <a class="el" href="../../de/dbb/_contacts_8cc_source.html">Contacts.cc</a>.</p>

<p>References <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00276">ConstraintSet::a</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00233">ConstraintSet::acceleration</a>, <a class="el" href="../../d4/d41/_spatial_algebra_operators_8h_source.html#l00233">SpatialTransform::applyAdjoint()</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00227">ConstraintSet::body</a>, <a class="el" href="../../d4/de5/_kinematics_8cc_source.html#l00167">RigidBodyDynamics::CalcBodyToBaseCoordinates()</a>, <a class="el" href="../../d4/de5/_kinematics_8cc_source.html#l00525">RigidBodyDynamics::CalcPointAcceleration()</a>, <a class="el" href="../../da/ded/_model_8h_source.html#l00139">Model::dof_count</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00284">ConstraintSet::f_ext_constraints</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00282">ConstraintSet::f_t</a>, <a class="el" href="../../da/ded/_model_8h_source.html#l00253">Model::fixed_body_discriminator</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00235">ConstraintSet::force</a>, <a class="el" href="../../de/d3c/_dynamics_8cc_source.html#l00311">RigidBodyDynamics::ForwardDynamics()</a>, <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00702">RigidBodyDynamics::ForwardDynamicsAccelerationDeltas()</a>, <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00530">RigidBodyDynamics::ForwardDynamicsApplyConstraintForces()</a>, <a class="el" href="../../da/ded/_model_8h_source.html#l00396">Model::IsFixedBodyId()</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00274">ConstraintSet::K</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00222">ConstraintSet::linear_solver</a>, <a class="el" href="../../d1/d49/rbdl__mathutils_8h_source.html#l00028">LinearSolverColPivHouseholderQR</a>, <a class="el" href="../../d1/d49/rbdl__mathutils_8h_source.html#l00028">LinearSolverHouseholderQR</a>, <a class="el" href="../../d1/d49/rbdl__mathutils_8h_source.html#l00028">LinearSolverPartialPivLU</a>, <a class="el" href="../../df/d59/rbdl__mathutils_8cc_source.html#l00054">RigidBodyDynamics::Math::LinSolveGaussElimPivot()</a>, <a class="el" href="../../da/def/_logging_8h_source.html#l00024">LOG</a>, <a class="el" href="../../da/ded/_model_8h_source.html#l00262">Model::mBodies</a>, <a class="el" href="../../da/ded/_model_8h_source.html#l00240">Model::mFixedBodies</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00229">ConstraintSet::normal</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00228">ConstraintSet::point</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00286">ConstraintSet::point_accel_0</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00280">ConstraintSet::QDDot_0</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00278">ConstraintSet::QDDot_t</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00214">ConstraintSet::size()</a>, <a class="el" href="../../da/def/_logging_8h_source.html#l00025">SUPPRESS_LOGGING</a>, and <a class="el" href="../../d4/de5/_kinematics_8cc_source.html#l00087">RigidBodyDynamics::UpdateKinematicsCustom()</a>.</p>

</div>
</div>
<a class="anchor" id="gadc45154c3287dbeeb10aa38ae1ced107"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RBDL_DLLAPI void ForwardDynamicsContactsNullSpace </td>
          <td>(</td>
          <td class="paramtype">Model &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const VectorNd &amp;&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const VectorNd &amp;&#160;</td>
          <td class="paramname"><em>QDot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const VectorNd &amp;&#160;</td>
          <td class="paramname"><em>Tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ConstraintSet &amp;&#160;</td>
          <td class="paramname"><em>CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VectorNd &amp;&#160;</td>
          <td class="paramname"><em>QDDot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00428">428</a> of file <a class="el" href="../../de/dbb/_contacts_8cc_source.html">Contacts.cc</a>.</p>

<p>References <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00247">ConstraintSet::C</a>, <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00343">RigidBodyDynamics::CalcContactSystemVariables()</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00235">ConstraintSet::force</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00250">ConstraintSet::G</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00249">ConstraintSet::gamma</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00262">ConstraintSet::GT_qr</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00265">ConstraintSet::GT_qr_Q</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00245">ConstraintSet::H</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00222">ConstraintSet::linear_solver</a>, <a class="el" href="../../da/def/_logging_8h_source.html#l00024">LOG</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00268">ConstraintSet::qddot_y</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00269">ConstraintSet::qddot_z</a>, <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00248">RigidBodyDynamics::SolveContactSystemNullSpace()</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00266">ConstraintSet::Y</a>, and <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00267">ConstraintSet::Z</a>.</p>

</div>
</div>
<a class="anchor" id="gaf140d8cf9b423912c21c8ddb703f6175"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RBDL_DLLAPI void ForwardDynamicsContactsRangeSpaceSparse </td>
          <td>(</td>
          <td class="paramtype">Model &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>QDot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>Tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ConstraintSet &amp;&#160;</td>
          <td class="paramname"><em>CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>QDDot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00414">414</a> of file <a class="el" href="../../de/dbb/_contacts_8cc_source.html">Contacts.cc</a>.</p>

<p>References <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00276">ConstraintSet::a</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00247">ConstraintSet::C</a>, <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00343">RigidBodyDynamics::CalcContactSystemVariables()</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00235">ConstraintSet::force</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00250">ConstraintSet::G</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00249">ConstraintSet::gamma</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00245">ConstraintSet::H</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00274">ConstraintSet::K</a>, <a class="el" href="../../d7/d4e/_contacts_8h_source.html#l00222">ConstraintSet::linear_solver</a>, and <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00211">RigidBodyDynamics::SolveContactSystemRangeSpaceSparse()</a>.</p>

</div>
</div>
<a class="anchor" id="ga77fdfb3e7d52e77ef0d5146747e4f3fc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RBDL_DLLAPI void SolveContactSystemDirect </td>
          <td>(</td>
          <td class="paramtype">Math::MatrixNd &amp;&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::MatrixNd &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>qddot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::MatrixNd &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::LinearSolver &amp;&#160;</td>
          <td class="paramname"><em>linear_solver</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solves the full contact system directly, i.e. simultaneously for contact forces and joint accelerations. </p>
<p>This solves a <img class="formulaInl" alt="$ (n_\textit{dof} + n_c) \times (n_\textit{dof} + n_c$" src="../../form_20.png"/> linear system.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">H</td><td>the joint space inertia matrix </td></tr>
    <tr><td class="paramname">G</td><td>the constraint jacobian </td></tr>
    <tr><td class="paramname">c</td><td>the <img class="formulaInl" alt="$ \mathbb{R}^{n_\textit{dof}}$" src="../../form_21.png"/> vector of the upper part of the right hand side of the system </td></tr>
    <tr><td class="paramname">gamma</td><td>the <img class="formulaInl" alt="$ \mathbb{R}^{n_c}$" src="../../form_22.png"/> vector of the lower part of the right hand side of the system </td></tr>
    <tr><td class="paramname">qddot</td><td>result: joint accelerations </td></tr>
    <tr><td class="paramname">lambda</td><td>result: constraint forces </td></tr>
    <tr><td class="paramname">A</td><td>work-space for the matrix of the linear system </td></tr>
    <tr><td class="paramname">b</td><td>work-space for the right-hand-side of the linear system </td></tr>
    <tr><td class="paramname">x</td><td>work-space for the solution of the linear system </td></tr>
    <tr><td class="paramname">type</td><td>of solver that should be used to solve the system </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00161">161</a> of file <a class="el" href="../../de/dbb/_contacts_8cc_source.html">Contacts.cc</a>.</p>

<p>References <a class="el" href="../../d1/d49/rbdl__mathutils_8h_source.html#l00028">LinearSolverColPivHouseholderQR</a>, <a class="el" href="../../d1/d49/rbdl__mathutils_8h_source.html#l00028">LinearSolverHouseholderQR</a>, <a class="el" href="../../d1/d49/rbdl__mathutils_8h_source.html#l00028">LinearSolverPartialPivLU</a>, and <a class="el" href="../../da/def/_logging_8h_source.html#l00024">LOG</a>.</p>

</div>
</div>
<a class="anchor" id="ga8bac05d59832b1431a4a12f32eb3d8d5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RBDL_DLLAPI void SolveContactSystemNullSpace </td>
          <td>(</td>
          <td class="paramtype">Math::MatrixNd &amp;&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::MatrixNd &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>qddot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::MatrixNd &amp;&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::MatrixNd &amp;&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>qddot_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>qddot_z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::LinearSolver &amp;&#160;</td>
          <td class="paramname"><em>linear_solver</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solves the contact system by first solving for the joint accelerations and then for the constraint forces. </p>
<p>This methods requires a <img class="formulaInl" alt="$n_\textit{dof} \times n_\textit{dof}$" src="../../form_24.png"/> matrix of the form <img class="formulaInl" alt="$\left[ \ Y \ | Z \ \right]$" src="../../form_25.png"/> with the property <img class="formulaInl" alt="$GZ = 0$" src="../../form_26.png"/> that can be computed using a QR decomposition (e.g. see code for <a class="el" href="../../d6/d0a/group__contacts__group.html#gadc45154c3287dbeeb10aa38ae1ced107">ForwardDynamicsContactsNullSpace()</a>).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">H</td><td>the joint space inertia matrix </td></tr>
    <tr><td class="paramname">G</td><td>the constraint jacobian </td></tr>
    <tr><td class="paramname">c</td><td>the <img class="formulaInl" alt="$ \mathbb{R}^{n_\textit{dof}}$" src="../../form_21.png"/> vector of the upper part of the right hand side of the system </td></tr>
    <tr><td class="paramname">gamma</td><td>the <img class="formulaInl" alt="$ \mathbb{R}^{n_c}$" src="../../form_22.png"/> vector of the lower part of the right hand side of the system </td></tr>
    <tr><td class="paramname">qddot</td><td>result: joint accelerations </td></tr>
    <tr><td class="paramname">lambda</td><td>result: constraint forces </td></tr>
    <tr><td class="paramname">Y</td><td>basis for the range-space of the constraints </td></tr>
    <tr><td class="paramname">Z</td><td>basis for the null-space of the constraints </td></tr>
    <tr><td class="paramname">qddot_y</td><td>work-space of size <img class="formulaInl" alt="$\mathbb{R}^{n_\textit{dof}}$" src="../../form_27.png"/> </td></tr>
    <tr><td class="paramname">qddot_z</td><td>work-space of size <img class="formulaInl" alt="$\mathbb{R}^{n_\textit{dof}}$" src="../../form_27.png"/> </td></tr>
    <tr><td class="paramname">linear_solver</td><td>type of solver that should be used to solve the system </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00248">248</a> of file <a class="el" href="../../de/dbb/_contacts_8cc_source.html">Contacts.cc</a>.</p>

<p>References <a class="el" href="../../d1/d49/rbdl__mathutils_8h_source.html#l00028">LinearSolverColPivHouseholderQR</a>, <a class="el" href="../../d1/d49/rbdl__mathutils_8h_source.html#l00028">LinearSolverHouseholderQR</a>, <a class="el" href="../../d1/d49/rbdl__mathutils_8h_source.html#l00028">LinearSolverPartialPivLU</a>, and <a class="el" href="../../da/def/_logging_8h_source.html#l00024">LOG</a>.</p>

</div>
</div>
<a class="anchor" id="ga58bd5b79a0971abe3fc06703f17175ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RBDL_DLLAPI void SolveContactSystemRangeSpaceSparse </td>
          <td>(</td>
          <td class="paramtype">Model &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::MatrixNd &amp;&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::MatrixNd &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>qddot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::MatrixNd &amp;&#160;</td>
          <td class="paramname"><em>K</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::VectorNd &amp;&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Math::LinearSolver&#160;</td>
          <td class="paramname"><em>linear_solver</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solves the contact system by first solving for the the joint accelerations and then the contact forces using a sparse matrix decomposition of the joint space inertia matrix. </p>
<p>This method exploits the branch-induced sparsity by the structure preserving <img class="formulaInl" alt="$L^TL $" src="../../form_23.png"/> decomposition described in RBDL, Section 6.5.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">H</td><td>the joint space inertia matrix </td></tr>
    <tr><td class="paramname">G</td><td>the constraint jacobian </td></tr>
    <tr><td class="paramname">c</td><td>the <img class="formulaInl" alt="$ \mathbb{R}^{n_\textit{dof}}$" src="../../form_21.png"/> vector of the upper part of the right hand side of the system </td></tr>
    <tr><td class="paramname">gamma</td><td>the <img class="formulaInl" alt="$ \mathbb{R}^{n_c}$" src="../../form_22.png"/> vector of the lower part of the right hand side of the system </td></tr>
    <tr><td class="paramname">qddot</td><td>result: joint accelerations </td></tr>
    <tr><td class="paramname">lambda</td><td>result: constraint forces </td></tr>
    <tr><td class="paramname">K</td><td>work-space for the matrix of the constraint force linear system </td></tr>
    <tr><td class="paramname">a</td><td>work-space for the right-hand-side of the constraint force linear system </td></tr>
    <tr><td class="paramname">linear_solver</td><td>type of solver that should be used to solve the constraint force system </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../de/dbb/_contacts_8cc_source.html#l00211">211</a> of file <a class="el" href="../../de/dbb/_contacts_8cc_source.html">Contacts.cc</a>.</p>

<p>References <a class="el" href="../../df/d59/rbdl__mathutils_8cc_source.html#l00275">RigidBodyDynamics::Math::SparseFactorizeLTL()</a>, <a class="el" href="../../df/d59/rbdl__mathutils_8cc_source.html#l00325">RigidBodyDynamics::Math::SparseSolveLTx()</a>, and <a class="el" href="../../df/d59/rbdl__mathutils_8cc_source.html#l00314">RigidBodyDynamics::Math::SparseSolveLx()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Jul 27 2016 14:00:33 for Rigid Body Dynamics Library by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
